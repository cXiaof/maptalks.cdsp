/*!
 * maptalks.multisuite v0.1.0-beta.3
 * LICENSE : MIT
 * (c) 2016-2019 maptalks.org
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.maptalks=t.maptalks||{})}(this,function(t){"use strict";var te="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var e,ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=(function(t,e){var r="__lodash_hash_undefined__",b=1,v=2,o=9007199254740991,m="[object Arguments]",g="[object Array]",n="[object AsyncFunction]",S="[object Boolean]",j="[object Date]",k="[object Error]",i="[object Function]",s="[object GeneratorFunction]",G="[object Map]",w="[object Number]",a="[object Null]",O="[object Object]",c="[object Promise]",u="[object Proxy]",T="[object RegExp]",C="[object Set]",P="[object String]",A="[object Symbol]",h="[object Undefined]",l="[object WeakMap]",E="[object ArrayBuffer]",L="[object DataView]",f=/^\[object .+?Constructor\]$/,p=/^(?:0|[1-9]\d*)$/,_={};_["[object Float32Array]"]=_["[object Float64Array]"]=_["[object Int8Array]"]=_["[object Int16Array]"]=_["[object Int32Array]"]=_["[object Uint8Array]"]=_["[object Uint8ClampedArray]"]=_["[object Uint16Array]"]=_["[object Uint32Array]"]=!0,_[m]=_[g]=_[E]=_[S]=_[L]=_[j]=_[k]=_[i]=_[G]=_[w]=_[O]=_[T]=_[C]=_[P]=_[l]=!1;var y="object"==ee(te)&&te&&te.Object===Object&&te,d="object"==("undefined"==typeof self?"undefined":ee(self))&&self&&self.Object===Object&&self,W=y||d||Function("return this")(),z=e&&!e.nodeType&&e,M=z&&t&&!t.nodeType&&t,F=M&&M.exports===z,x=F&&y.process,I=function(){try{return x&&x.binding&&x.binding("util")}catch(t){}}(),R=I&&I.isTypedArray;function D(t,e){for(var o=-1,r=null==t?0:t.length;++o<r;)if(e(t[o],o,t))return!0;return!1}function N(t){var o=-1,r=Array(t.size);return t.forEach(function(t,e){r[++o]=[e,t]}),r}function $(t){var e=-1,o=Array(t.size);return t.forEach(function(t){o[++e]=t}),o}var H,U,B,V=Array.prototype,J=Function.prototype,X=Object.prototype,Y=W["__core-js_shared__"],Z=J.toString,q=X.hasOwnProperty,K=(H=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+H:"",Q=X.toString,tt=RegExp("^"+Z.call(q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=F?W.Buffer:void 0,ot=W.Symbol,rt=W.Uint8Array,nt=X.propertyIsEnumerable,it=V.splice,st=ot?ot.toStringTag:void 0,at=Object.getOwnPropertySymbols,ct=et?et.isBuffer:void 0,ut=(U=Object.keys,B=Object,function(t){return U(B(t))}),ht=It(W,"DataView"),lt=It(W,"Map"),ft=It(W,"Promise"),pt=It(W,"Set"),_t=It(W,"WeakMap"),yt=It(Object,"create"),dt=$t(ht),vt=$t(lt),mt=$t(ft),gt=$t(pt),bt=$t(_t),St=ot?ot.prototype:void 0,jt=St?St.valueOf:void 0;function kt(t){var e=-1,o=null==t?0:t.length;for(this.clear();++e<o;){var r=t[e];this.set(r[0],r[1])}}function Gt(t){var e=-1,o=null==t?0:t.length;for(this.clear();++e<o;){var r=t[e];this.set(r[0],r[1])}}function wt(t){var e=-1,o=null==t?0:t.length;for(this.clear();++e<o;){var r=t[e];this.set(r[0],r[1])}}function Ot(t){var e=-1,o=null==t?0:t.length;for(this.__data__=new wt;++e<o;)this.add(t[e])}function Tt(t){var e=this.__data__=new Gt(t);this.size=e.size}function Ct(t,e){var o=Bt(t),r=!o&&Ut(t),n=!o&&!r&&Vt(t),i=!o&&!r&&!n&&Kt(t),s=o||r||n||i,a=s?function(t,e){for(var o=-1,r=Array(t);++o<t;)r[o]=e(o);return r}(t.length,String):[],c=a.length;for(var u in t)!e&&!q.call(t,u)||s&&("length"==u||n&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Nt(u,c))||a.push(u);return a}function Pt(t,e){for(var o=t.length;o--;)if(Ht(t[o][0],e))return o;return-1}function At(t){return null==t?void 0===t?h:a:st&&st in Object(t)?function(t){var e=q.call(t,st),o=t[st];try{var r=!(t[st]=void 0)}catch(t){}var n=Q.call(t);r&&(e?t[st]=o:delete t[st]);return n}(t):(e=t,Q.call(e));var e}function Et(t){return Zt(t)&&At(t)==m}function Lt(t,e,o,r,n){return t===e||(null==t||null==e||!Zt(t)&&!Zt(e)?t!=t&&e!=e:function(t,e,o,r,n,i){var s=Bt(t),a=Bt(e),c=s?g:Dt(t),u=a?g:Dt(e),h=(c=c==m?O:c)==O,l=(u=u==m?O:u)==O,f=c==u;if(f&&Vt(t)){if(!Vt(e))return!1;h=!(s=!0)}if(f&&!h)return i||(i=new Tt),s||Kt(t)?Mt(t,e,o,r,n,i):function(t,e,o,r,n,i,s){switch(o){case L:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case E:return!(t.byteLength!=e.byteLength||!i(new rt(t),new rt(e)));case S:case j:case w:return Ht(+t,+e);case k:return t.name==e.name&&t.message==e.message;case T:case P:return t==e+"";case G:var a=N;case C:var c=r&b;if(a||(a=$),t.size!=e.size&&!c)return!1;var u=s.get(t);if(u)return u==e;r|=v,s.set(t,e);var h=Mt(a(t),a(e),r,n,i,s);return s.delete(t),h;case A:if(jt)return jt.call(t)==jt.call(e)}return!1}(t,e,c,o,r,n,i);if(!(o&b)){var p=h&&q.call(t,"__wrapped__"),_=l&&q.call(e,"__wrapped__");if(p||_){var y=p?t.value():t,d=_?e.value():e;return i||(i=new Tt),n(y,d,o,r,i)}}if(!f)return!1;return i||(i=new Tt),function(t,e,o,r,n,i){var s=o&b,a=Ft(t),c=a.length,u=Ft(e).length;if(c!=u&&!s)return!1;for(var h=c;h--;){var l=a[h];if(!(s?l in e:q.call(e,l)))return!1}var f=i.get(t);if(f&&i.get(e))return f==e;var p=!0;i.set(t,e),i.set(e,t);for(var _=s;++h<c;){l=a[h];var y=t[l],d=e[l];if(r)var v=s?r(d,y,l,e,t,i):r(y,d,l,t,e,i);if(!(void 0===v?y===d||n(y,d,o,r,i):v)){p=!1;break}_||(_="constructor"==l)}if(p&&!_){var m=t.constructor,g=e.constructor;m!=g&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof g&&g instanceof g)&&(p=!1)}return i.delete(t),i.delete(e),p}(t,e,o,r,n,i)}(t,e,o,r,Lt,n))}function Wt(t){return!(!Yt(t)||(e=t,K&&K in e))&&(Jt(t)?tt:f).test($t(t));var e}function zt(t){if(o=(e=t)&&e.constructor,r="function"==typeof o&&o.prototype||X,e!==r)return ut(t);var e,o,r,n=[];for(var i in Object(t))q.call(t,i)&&"constructor"!=i&&n.push(i);return n}function Mt(t,e,r,n,i,s){var o=r&b,a=t.length,c=e.length;if(a!=c&&!(o&&a<c))return!1;var u=s.get(t);if(u&&s.get(e))return u==e;var h=-1,l=!0,f=r&v?new Ot:void 0;for(s.set(t,e),s.set(e,t);++h<a;){var p=t[h],_=e[h];if(n)var y=o?n(_,p,h,e,t,s):n(p,_,h,t,e,s);if(void 0!==y){if(y)continue;l=!1;break}if(f){if(!D(e,function(t,e){if(o=e,!f.has(o)&&(p===t||i(p,t,r,n,s)))return f.push(e);var o})){l=!1;break}}else if(p!==_&&!i(p,_,r,n,s)){l=!1;break}}return s.delete(t),s.delete(e),l}function Ft(t){return o=Rt,r=Qt(e=t),Bt(e)?r:function(t,e){for(var o=-1,r=e.length,n=t.length;++o<r;)t[n+o]=e[o];return t}(r,o(e));var e,o,r}function xt(t,e){var o,r,n=t.__data__;return("string"==(r=void 0===(o=e)?"undefined":ee(o))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==o:null===o)?n["string"==typeof e?"string":"hash"]:n.map}function It(t,e){var o,r,n=(r=e,null==(o=t)?void 0:o[r]);return Wt(n)?n:void 0}kt.prototype.clear=function(){this.__data__=yt?yt(null):{},this.size=0},kt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},kt.prototype.get=function(t){var e=this.__data__;if(yt){var o=e[t];return o===r?void 0:o}return q.call(e,t)?e[t]:void 0},kt.prototype.has=function(t){var e=this.__data__;return yt?void 0!==e[t]:q.call(e,t)},kt.prototype.set=function(t,e){var o=this.__data__;return this.size+=this.has(t)?0:1,o[t]=yt&&void 0===e?r:e,this},Gt.prototype.clear=function(){this.__data__=[],this.size=0},Gt.prototype.delete=function(t){var e=this.__data__,o=Pt(e,t);return!(o<0||(o==e.length-1?e.pop():it.call(e,o,1),--this.size,0))},Gt.prototype.get=function(t){var e=this.__data__,o=Pt(e,t);return o<0?void 0:e[o][1]},Gt.prototype.has=function(t){return-1<Pt(this.__data__,t)},Gt.prototype.set=function(t,e){var o=this.__data__,r=Pt(o,t);return r<0?(++this.size,o.push([t,e])):o[r][1]=e,this},wt.prototype.clear=function(){this.size=0,this.__data__={hash:new kt,map:new(lt||Gt),string:new kt}},wt.prototype.delete=function(t){var e=xt(this,t).delete(t);return this.size-=e?1:0,e},wt.prototype.get=function(t){return xt(this,t).get(t)},wt.prototype.has=function(t){return xt(this,t).has(t)},wt.prototype.set=function(t,e){var o=xt(this,t),r=o.size;return o.set(t,e),this.size+=o.size==r?0:1,this},Ot.prototype.add=Ot.prototype.push=function(t){return this.__data__.set(t,r),this},Ot.prototype.has=function(t){return this.__data__.has(t)},Tt.prototype.clear=function(){this.__data__=new Gt,this.size=0},Tt.prototype.delete=function(t){var e=this.__data__,o=e.delete(t);return this.size=e.size,o},Tt.prototype.get=function(t){return this.__data__.get(t)},Tt.prototype.has=function(t){return this.__data__.has(t)},Tt.prototype.set=function(t,e){var o=this.__data__;if(o instanceof Gt){var r=o.__data__;if(!lt||r.length<199)return r.push([t,e]),this.size=++o.size,this;o=this.__data__=new wt(r)}return o.set(t,e),this.size=o.size,this};var Rt=at?function(e){return null==e?[]:(e=Object(e),function(t,e){for(var o=-1,r=null==t?0:t.length,n=0,i=[];++o<r;){var s=t[o];e(s,o,t)&&(i[n++]=s)}return i}(at(e),function(t){return nt.call(e,t)}))}:function(){return[]},Dt=At;function Nt(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||p.test(t))&&-1<t&&t%1==0&&t<e}function $t(t){if(null!=t){try{return Z.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Ht(t,e){return t===e||t!=t&&e!=e}(ht&&Dt(new ht(new ArrayBuffer(1)))!=L||lt&&Dt(new lt)!=G||ft&&Dt(ft.resolve())!=c||pt&&Dt(new pt)!=C||_t&&Dt(new _t)!=l)&&(Dt=function(t){var e=At(t),o=e==O?t.constructor:void 0,r=o?$t(o):"";if(r)switch(r){case dt:return L;case vt:return G;case mt:return c;case gt:return C;case bt:return l}return e});var Ut=Et(function(){return arguments}())?Et:function(t){return Zt(t)&&q.call(t,"callee")&&!nt.call(t,"callee")},Bt=Array.isArray;var Vt=ct||function(){return!1};function Jt(t){if(!Yt(t))return!1;var e=At(t);return e==i||e==s||e==n||e==u}function Xt(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=o}function Yt(t){var e=void 0===t?"undefined":ee(t);return null!=t&&("object"==e||"function"==e)}function Zt(t){return null!=t&&"object"==(void 0===t?"undefined":ee(t))}var qt,Kt=R?(qt=R,function(t){return qt(t)}):function(t){return Zt(t)&&Xt(t.length)&&!!_[At(t)]};function Qt(t){return null!=(e=t)&&Xt(e.length)&&!Jt(e)?Ct(t):zt(t);var e}t.exports=function(t,e){return Lt(t,e)}}(e={exports:{}},e.exports),e.exports),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="__lodash_hash_undefined__",o=9007199254740991,n="[object Arguments]",a="[object Function]",c="[object GeneratorFunction]",u=/^\[object .+?Constructor\]$/,h="object"==s(te)&&te&&te.Object===Object&&te,l="object"==("undefined"==typeof self?"undefined":s(self))&&self&&self.Object===Object&&self,f=h||l||Function("return this")();function p(t,e){return!!(t?t.length:0)&&-1<function(t,e,o){if(e!=e)return function(t,e,o,r){var n=t.length,i=o+(r?1:-1);for(;r?i--:++i<n;)if(e(t[i],i,t))return i;return-1}(t,d,o);var r=o-1,n=t.length;for(;++r<n;)if(t[r]===e)return r;return-1}(t,e,0)}function _(t,e,o){for(var r=-1,n=t?t.length:0;++r<n;)if(o(e,t[r]))return!0;return!1}function y(t,e){for(var o=-1,r=e.length,n=t.length;++o<r;)t[n+o]=e[o];return t}function d(t){return t!=t}function v(t,e){return t.has(e)}function m(t){var e=-1,o=Array(t.size);return t.forEach(function(t){o[++e]=t}),o}var g,b=Array.prototype,S=Function.prototype,j=Object.prototype,k=f["__core-js_shared__"],G=(g=/[^.]+$/.exec(k&&k.keys&&k.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",w=S.toString,O=j.hasOwnProperty,T=j.toString,C=RegExp("^"+w.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),P=f.Symbol,A=j.propertyIsEnumerable,E=b.splice,L=P?P.isConcatSpreadable:void 0,W=Math.max,z=B(f,"Map"),M=B(f,"Set"),F=B(Object,"create");function x(t){var e=-1,o=t?t.length:0;for(this.clear();++e<o;){var r=t[e];this.set(r[0],r[1])}}function I(t){var e=-1,o=t?t.length:0;for(this.clear();++e<o;){var r=t[e];this.set(r[0],r[1])}}function R(t){var e=-1,o=t?t.length:0;for(this.clear();++e<o;){var r=t[e];this.set(r[0],r[1])}}function D(t){var e=-1,o=t?t.length:0;for(this.__data__=new R;++e<o;)this.add(t[e])}function N(t,e){for(var o,r,n=t.length;n--;)if((o=t[n][0])===(r=e)||o!=o&&r!=r)return n;return-1}function $(t){return!(!Q(t)||(e=t,G&&G in e))&&(K(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?C:u).test(function(t){if(null!=t){try{return w.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}x.prototype.clear=function(){this.__data__=F?F(null):{}},x.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},x.prototype.get=function(t){var e=this.__data__;if(F){var o=e[t];return o===r?void 0:o}return O.call(e,t)?e[t]:void 0},x.prototype.has=function(t){var e=this.__data__;return F?void 0!==e[t]:O.call(e,t)},x.prototype.set=function(t,e){return this.__data__[t]=F&&void 0===e?r:e,this},I.prototype.clear=function(){this.__data__=[]},I.prototype.delete=function(t){var e=this.__data__,o=N(e,t);return!(o<0||(o==e.length-1?e.pop():E.call(e,o,1),0))},I.prototype.get=function(t){var e=this.__data__,o=N(e,t);return o<0?void 0:e[o][1]},I.prototype.has=function(t){return-1<N(this.__data__,t)},I.prototype.set=function(t,e){var o=this.__data__,r=N(o,t);return r<0?o.push([t,e]):o[r][1]=e,this},R.prototype.clear=function(){this.__data__={hash:new x,map:new(z||I),string:new x}},R.prototype.delete=function(t){return U(this,t).delete(t)},R.prototype.get=function(t){return U(this,t).get(t)},R.prototype.has=function(t){return U(this,t).has(t)},R.prototype.set=function(t,e){return U(this,t).set(t,e),this},D.prototype.add=D.prototype.push=function(t){return this.__data__.set(t,r),this},D.prototype.has=function(t){return this.__data__.has(t)};var H=M&&1/m(new M([,-0]))[1]==1/0?function(t){return new M(t)}:function(){};function U(t,e){var o,r,n=t.__data__;return("string"==(r=void 0===(o=e)?"undefined":s(o))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==o:null===o)?n["string"==typeof e?"string":"hash"]:n.map}function B(t,e){var o,r,n=(r=e,null==(o=t)?void 0:o[r]);return $(n)?n:void 0}function V(t){return Y(t)||q(e=t)&&O.call(e,"callee")&&(!A.call(e,"callee")||T.call(e)==n)||!!(L&&t&&t[L]);var e}var J,X;J=function(t){var e,o,r=(o=(e=t)?e.length:0)?e[o-1]:void 0;return q(r)&&(r=void 0),function(t,e,o){var r=-1,n=p,i=t.length,s=!0,a=[],c=a;if(o)s=!1,n=_;else if(200<=i){var u=e?null:H(t);if(u)return m(u);s=!1,n=v,c=new D}else c=e?[]:a;t:for(;++r<i;){var h=t[r],l=e?e(h):h;if(h=o||0!==h?h:0,s&&l==l){for(var f=c.length;f--;)if(c[f]===l)continue t;e&&c.push(l),a.push(h)}else n(c,l,o)||(c!==a&&c.push(l),a.push(h))}return a}(function t(e,o,r,n,i){var s=-1,a=e.length;for(r||(r=V),i||(i=[]);++s<a;){var c=e[s];0<o&&r(c)?1<o?t(c,o-1,r,n,i):y(i,c):n||(i[i.length]=c)}return i}(t,1,q,!0),void 0,r)},X=W(void 0===X?J.length-1:X,0);var Y=Array.isArray;function Z(t){return null!=t&&("number"==typeof(e=t.length)&&-1<e&&e%1==0&&e<=o)&&!K(t);var e}function q(t){return!!(e=t)&&"object"==(void 0===e?"undefined":s(e))&&Z(t);var e}function K(t){var e=Q(t)?T.call(t):"";return e==a||e==c}function Q(t){var e=void 0===t?"undefined":s(t);return!!t&&("object"==e||"function"==e)}var tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et="object"==tt(te)&&te&&te.Object===Object&&te,ot="object"==("undefined"==typeof self?"undefined":tt(self))&&self&&self.Object===Object&&self,rt=et||ot||Function("return this")();var nt=Object.prototype,it=(nt.hasOwnProperty,nt.toString,rt.Symbol);nt.propertyIsEnumerable,it&&it.isConcatSpreadable;Array.isArray;function st(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):function(t,e){for(var o=Object.getOwnPropertyNames(e),r=0;r<o.length;r++){var n=o[r],i=Object.getOwnPropertyDescriptor(e,n);i&&i.configurable&&void 0===t[n]&&Object.defineProperty(t,n,i)}}(t,e))}var at=function(o){function r(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,t));return e._layerName=maptalks.INTERNAL_LAYER_PREFIX+"_CDSP",e._layerTMP=maptalks.INTERNAL_LAYER_PREFIX+"_CDSP_TMP",e._chooseGeos=[],e._colorHit="#ffa400",e._colorChoose="#00bcd4",e._markerStyleDefault={markerType:"path",markerPath:[{path:"M8 23l0 0 0 0 0 0 0 0 0 0c-4,-5 -8,-10 -8,-14 0,-5 4,-9 8,-9l0 0 0 0c4,0 8,4 8,9 0,4 -4,9 -8,14z M3,9 a5,5 0,1,0,0,-0.9Z",fill:"#DE3333"}],markerPathWidth:16,markerPathHeight:23,markerWidth:24,markerHeight:34},e}return st(r,o),r.prototype.combine=function(t,e){if(t instanceof maptalks.Geometry)return this._initialTaskWithGeo(t,"combine"),e instanceof maptalks.Geometry&&(e=[e]),e instanceof Array&&0<e.length?this._compositWithTargets(e):this._initialChooseGeos(t),this},r.prototype.decompose=function(t,e){if(t instanceof maptalks.GeometryCollection)return this._initialTaskWithGeo(t,"decompose"),e instanceof maptalks.Geometry&&(e=[e]),e instanceof Array&&0<e.length?this._decomposeWithTargets(e):this._initialChooseGeos(t),this},r.prototype.peel=function(t,e){if(t instanceof maptalks.Polygon)return this._initialTaskWithGeo(t,"peel"),e instanceof maptalks.Polygon&&(e=[e]),e instanceof Array&&0<e.length&&(this._peelWithTargets(e),this.remove()),this},r.prototype.fill=function(t,e,o){var r=this;if(t instanceof maptalks.MultiPolygon){if(this._initialTaskWithGeo(t,"fill"),o)this._fillAll(),this.remove();else if(e instanceof maptalks.Polygon&&(e=[e]),e instanceof Array&&0<e.length)this._fillWithTargets(e),this.remove();else{var n=this.geometry.getCoordinates()[0],i=this.geometry.getSymbol();i.polygonOpacity=0,n.forEach(function(t,e){0<e&&new maptalks.Polygon([n[e]],{symbol:i}).addTo(r._tmpLayer)})}return this}},r.prototype.submit=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){return!1};switch(this._task){case"combine":this._submitCombine();break;case"decompose":this._submitDecompose();break;case"peel":this._submitPeel();break;case"fill":this._submitFill()}return t(this._result,this._deals,this._task),this.remove(),this},r.prototype.cancel=function(){return this.remove(),this},r.prototype.remove=function(){this._map;return this._tmpLayer&&this._tmpLayer.remove(),this._chooseLayer&&this._chooseLayer.remove(),this._chooseGeos=[],this._offMapEvents(),delete this._result,delete this._deals,delete this._task,delete this._tmpLayer,delete this._chooseLayer,this},r.prototype._initialTaskWithGeo=function(t,e){this.geometry&&this.remove(),this._task=e,this._savePrivateGeometry(t)},r.prototype._initialChooseGeos=function(t){var e=this;switch(this._task){case"combine":this._chooseGeos=[t];break;case"decompose":t.forEach(function(t){return t.copy().addTo(e._tmpLayer)}),this._chooseGeos=this._tmpLayer.getGeometries()}this._updateChooseGeos()},r.prototype._savePrivateGeometry=function(t){this.geometry=t,this.layer=t.getLayer(),this._addTo(t.getMap())},r.prototype._addTo=function(t){this._chooseLayer&&this.remove(),t._map_tool&&t._map_tool instanceof maptalks.DrawTool&&t._map_tool.disable(),this._map=t,this._tmpLayer=this._newVectorLayerToFront(this._layerTMP),this._chooseLayer=this._newVectorLayerToFront(this._layerName),this._registerMapEvents()},r.prototype._newVectorLayerToFront=function(t){return new maptalks.VectorLayer(t).addTo(this._map).bringToFront()},r.prototype._registerMapEvents=function(){if(!this._mousemove){var t=this._map;this._mousemove=this._mousemoveEvents.bind(this),this._click=this._clickEvents.bind(this),t.on("mousemove",this._mousemove,this),t.on("click",this._click,this)}},r.prototype._offMapEvents=function(){if(this._mousemove){var t=this._map;t.off("mousemove",this._mousemove,this),t.off("click",this._click,this)}delete this._mousemove,delete this._click},r.prototype._mousemoveEvents=function(t){var o=this,r=[];switch(this._task){case"combine":r=this.layer.identify(t.coordinate);break;case"decompose":r=this._tmpLayer.identify(t.coordinate);break;case"peel":var n=this._getSafeCoords();this.layer.identify(t.coordinate).forEach(function(t){var e=o._getSafeCoords(t);i(e,n)||r.push(t)});break;case"fill":r=this._tmpLayer.identify(t.coordinate)}this._updateHitGeo(r)},r.prototype._getSafeCoords=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.geometry,e=t.getCoordinates();if(t.options.numberOfShellPoints){var o=t.options,r=o.numberOfShellPoints;o.numberOfShellPoints=300,t.setOptions(o),e=[t.getShell()],o.numberOfShellPoints=r||60,t.setOptions(o)}return e},r.prototype._updateHitGeo=function(t){if(this._needRefreshSymbol){var e=this._chooseLayer.getGeometryById("_hit");e&&(e.remove(),delete this.hitGeo),this._needRefreshSymbol=!1}if(t&&0<t.length)if(this._needRefreshSymbol=!0,this.hitGeo=t[0],this._checkIsSameType(this.hitGeo)){var o=this._getSymbolOrDefault(this.hitGeo,"Hit");this._copyGeoUpdateSymbol(this.hitGeo,o).setId("_hit")}else delete this.hitGeo},r.prototype._checkIsSameType=function(t){var e=t.getType(),o=this.geometry.getType();return e.includes(o)||o.includes(e)},r.prototype._getSymbolOrDefault=function(t,e){var o=t.getSymbol(),r=this["_color"+e];if(o){for(var n in o)(n.endsWith("Fill")||n.endsWith("Color"))&&(o[n]=r);o.lineWidth=4}else o=t.getType().endsWith("Point")?Object.assign(this._markerStyleDefault,{markerFill:r}):{lineColor:r,lineWidth:4};return o},r.prototype._copyGeoUpdateSymbol=function(t,e){return t.copy().updateSymbol(e).addTo(this._chooseLayer)},r.prototype._clickEvents=function(t){switch(this._task){case"combine":this._clickCombine();break;case"decompose":this._clickDecompose(t);break;default:if(this.hitGeo){var e=this._getSafeCoords(this.hitGeo);this._setChooseGeosExceptHit(e),this._updateChooseGeos()}}},r.prototype._clickCombine=function(){if(this.hitGeo){var t=this._getSafeCoords(this.hitGeo),e=this._getSafeCoords();if(i(t,e))return null;this._setChooseGeosExceptHit(t),this._updateChooseGeos()}},r.prototype._setChooseGeosExceptHit=function(r){var n=this,t=this._chooseGeos.reduce(function(t,e){var o=n._getSafeCoords(e);return i(r,o)?t:[].concat(t,[e])},[]);t.length===this._chooseGeos.length?this._chooseGeos.push(this.hitGeo):this._chooseGeos=t},r.prototype._updateChooseGeos=function(){var o=this;this._chooseLayer.clear(),this._chooseGeos.forEach(function(t){var e=o._getSymbolOrDefault(t,"Choose");o._copyGeoUpdateSymbol(t,e)})},r.prototype._clickDecompose=function(t){var e=this._chooseLayer.identify(t.coordinate).reduce(function(t,e){return"_hit"!==e.getId()&&t.push(e),t},[]);if(0<e.length){var o=e[0],r=this._getSafeCoords(o);this._setChooseGeosExceptHit(r,!0),o.remove()}else this.hitGeo&&this._chooseGeos.push(this.hitGeo);this._updateChooseGeos()},r.prototype._submitCombine=function(){this._compositWithTargets()},r.prototype._compositWithTargets=function(){var r=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._chooseGeos;this._deals=t.map(function(t){return t.copy()});var n=this._getGeoStringifyCoords(t),e=this.layer.getGeometries().reduce(function(e,t){var o=r._getGeoStringifyCoords(t);return n.includes(o)&&(t.getType().startsWith("Multi")?t.forEach(function(t){return e.push(t.copy())}):e.push(t.copy()),t.remove()),e},[]);this._compositResultGeo(e)},r.prototype._getGeoStringifyCoords=function(t){var e=this;return t instanceof Array?t.map(function(t){return JSON.stringify(e._getSafeCoords(t))}):JSON.stringify(this._getSafeCoords(t))},r.prototype._compositResultGeo=function(t){var e=t.length;if(!e||0===e)return null;var o=void 0;if(1<e)switch(t[0].getType()){case"Point":o=new maptalks.MultiPoint(t);break;case"LineString":o=new maptalks.MultiLineString(t);break;default:o=new maptalks.MultiPolygon(t)}else o=t[0].copy();o.setSymbol(this.geometry.getSymbol()),o.setProperties(this.geometry.getProperties()),o.addTo(this.layer),this._result=o},r.prototype._submitDecompose=function(){this._decomposeWithTargets()},r.prototype._decomposeWithTargets=function(){var r=this,n=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._chooseLayer.getGeometries()).reduce(function(t,e){return"_hit"!==e.getId()&&t.push(r._getGeoStringifyCoords(e)),t},[]),t=this._tmpLayer.getGeometries(),i=[];this._deals=t.reduce(function(t,e){var o=r._getGeoStringifyCoords(e);return n.includes(o)?i.push(e.copy()):(e=e.copy().addTo(r.layer),t.push(e)),t},[]),this.geometry.remove(),this._compositResultGeo(i)},r.prototype._peelWithTargets=function(){var o=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._chooseGeos,e=this.geometry;if(0<t.length){this._deals=[];var r=t.reduce(function(e,t){return t instanceof maptalks.MultiPolygon?t.forEach(function(t){return e.push(o._getSafeCoords(t)[0])}):e.push(o._getSafeCoords(t)[0]),o._deals.push(t.copy()),t.remove(),e},[this._getSafeCoords(e)[0]]);this._result=new maptalks.MultiPolygon([r],{symbol:e.getSymbol(),properties:e.getProperties()}).addTo(this.layer)}else this._result=e.copy().addTo(this.layer);e.remove()},r.prototype._submitPeel=function(){this._peelWithTargets()},r.prototype._submitFill=function(){this._fillWithTargets()},r.prototype._fillAll=function(){var t=this.geometry.getCoordinates(),e=this.geometry.getSymbol(),o=this.geometry.getProperties(),r=new maptalks.Polygon([t[0][0]],{symbol:e,properties:o}).addTo(this.layer);return this.geometry.remove(),r},r.prototype._fillWithTargets=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._chooseGeos,o=this.geometry.getSymbol(),e=this.geometry.getProperties(),r=[];this._deals=t.map(function(t){var e=JSON.stringify(t.getCoordinates()[0]);return r.push(e),t.copy().setSymbol(o)});var n=this.geometry.getCoordinates()[0].reduce(function(t,e){return r.includes(JSON.stringify(e))||t.push(e),t},[]);1===n.length?this._result=this._fillAll():(this._result=new maptalks.MultiPolygon([n],{symbol:o,properties:e}).addTo(this.layer),this.geometry.remove())},r}(maptalks.Class);at.mergeOptions({}),t.MultiSuite=at,Object.defineProperty(t,"__esModule",{value:!0}),"undefined"!=typeof console&&console.log("maptalks.multisuite v0.1.0-beta.3")});